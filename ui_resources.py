ST_STYLE = """
<style>
    /* Global Font */
    html, body, [class*="css"] {
        font-family: 'Roboto', 'Helvetica Neue', '微軟正黑體', sans-serif;
    }

    /* Metrics */
    div[data-testid="stMetricValue"] {
        border: 1px solid rgba(255, 255, 255, 0.2);
        background-color: #262730;
        color: white;
        transition: all 0.3s;
    }
    .stButton button:hover {
        border-color: #ff4b4b;
        color: #ff4b4b;
    }
    
    /* Expander */
    .streamlit-expanderHeader {
        background-color: #1c1e26;
        border-radius: 4px;
    }
</style>
"""

MANUAL_TEXT = """
# 📘 平台使用指南 (User Manual)

歡迎使用 **台股智投旗艦版**！本平台專為台股投資人設計，結合即時行情、技術分析與智能自動交易功能。

---

## 🚀 快速入門

1.  **自選股管理**:
    *   從左側欄「⚙️ 管理與新增」分頁，輸入代碼 (如 2330) 或從熱門清單選擇，建立您的觀察名單。
    *   支援多組清單 (如: "半導體", "高股息ETF")，可隨時切換。

2.  **個股分析**:
    *   查看 K 線圖、均線 (MA5, MA20) 與 MACD 指標。
    *   右側「⚡ 快速下單」面板可直接進行模擬交易 (現股/融券)。

3.  **投資組合**:
    *   查看目前的持倉部位、成本與未實現損益。
    *   提供「一鍵重置」功能，將帳戶還原至初始狀態 (1000萬)。

---

## 🤖 智能交易機器人 (Auto-Trading)

這是本平台的核心功能，能協助您 24 小時監控股市並自動執行交易。

### 1. 運作邏輯
*   **買進 (Buy)**: 當策略產生買進訊號 (Signal 1) 且資金充足時，買入設定的張數。
*   **賣出 (Sell)**: 當策略產生賣出訊號 (Signal -1) 時，**全數出清**該股庫存。
*   **風控 (Risk)**: 優先於策略。一旦觸發停損或停利，立即**強制平倉**。

### 2. 設定步驟
1.  **新增監控**: 在機器人頁面，從自選股中勾選要監控的股票，並設定「每次買進張數」。
2.  **設定參數**: 調整全域的「停損%」、「停利%」與「單檔資金上限」。
3.  **啟動**: 按下右側的「▶️ 啟動」按鈕。

### 3. 策略與最佳化
點擊「🚀 執行策略最佳化」，系統會針對每一檔監控中的股票，進行過去 1 年的回測，自動從以下策略中挑選最賺錢的一個：
*   **MA Cross**: 均線黃金/死亡交叉。
*   **RSI**: 超賣(<30)買進、超買(>70)賣出。
*   **MACD**: 柱狀圖趨勢反轉。
*   **KD**: KD 指標黃金/死亡交叉。

---

## 🔬 策略回測實驗室

不確定策略好不好？先測再說！
*   選擇標的與策略，設定回測期間 (預設 2 年)。
*   系統將計算 **總報酬率 (Total Return)**、**勝率 (Win Rate)** 與 **最大回撤 (MDD)**。
*   下方提供詳細的逐筆交易紀錄。

---

## ❓ 常見問題 (FAQ)

**Q: 關閉瀏覽器後，機器人還會跑嗎？**
A: **不會**。本平台依賴瀏覽器頁面運作 (Streamlit 機制)。請保持分頁開啟以維持自動交易。

**Q: 資料會不見嗎？**
A: 資料會儲存在您的專屬雲端設定檔中。只要使用相同帳號登入，設定都在。

**Q: 模擬資金用完了怎麼辦？**
A: 到「投資組合總覽」頁面最下方，點擊「確認清空資產」即可重置為 1000 萬。
"""
